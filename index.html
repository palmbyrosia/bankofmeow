<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bank of Meow - Login</title>
    <script type="module" src="js/firebase.js"></script>
    <script>

async function login() {
    const discordId = parseInt(document.getElementById('discord-id').value);
    const pin = parseInt(document.getElementById('pin').value);

    const userRef = doc(db, "accounts", discordId.toString());
    const userSnap = await getDoc(userRef);

    if (!userSnap.exists()) {
        // If the user does not exist, create a new account
        await setDoc(userRef, {
            id: discordId,
            pin: pin,
            balance: 0,
            latest_transaction: {
                amount: 0,
                recipient_id: 0,
                timestamp: null
            }
        });
        alert("New account created!");
    } else {
        const userData = userSnap.data();
        if (userData.pin === pin) {
            // Redirect to account page
            window.location.href = `account.html?id=${discordId}`;
        } else {
            alert("Invalid PIN");
        }
    }
}
    </script>
</head>
<body>
    <div id="login-container">
        <h2>Login to Bank of Meow</h2>
        <input type="number" id="discord-id" placeholder="Discord ID">
        <input type="password" id="pin" placeholder="PIN">
        <button onclick="login()">Login</button>
    </div>
</body>
</html>
